# 15.6 Практическая работа
## Создайте веб-приложение: маркетплейс для продажи товаров различными магазинами.
* `готово` Реализуйте регистрацию и аутентификацию пользователей.
* `готово` Реализуйте личный кабинет пользователя (должны отображаться: имя, баланс, текущий статус).
* `готово` Добавьте возможность пополнять баланс в личном кабинете аутентифицированного пользователя. Реализуйте пополнение баланса на отдельной странице с формой, в которой нужно указать сумму пополнения.
* `готово` Реализуйте страницу, на которой будет отображаться список товаров и названия магазинов, в которых они доступны.
* `готово` Реализуйте возможность формирования корзины и оплаты заказа (нужно списать товар из имеющегося остатка магазина), используя баланс личного кабинета (сумму покупки нужно списать с баланса пользователя).
* `готово` Реализуйте статусную систему для пользователей, которая будет зависеть от суммы покупок и автоматический перевод пользователя по ней.
* `готово` Реализуйте отчёт по наиболее продаваемым товарам за период времени (поля: идентификатор товара, название товара, количество проданных единиц).

### Примечания разработчика:
- Транзакции:
  - `+` Использованы во время подтверждения заказа (перемещаются элементы корзины в заказ)
  - `+` Использованы во время оплаты (уменьшение баланса, уменьшение количества товара на складе)
- Страницы:
  - `+` Главная страница
  - `+` Список товаров
    - `+` Изображение
    - Кнопка `Добавить в корзину` (внутри товара)
    - `+` Цена
    - `+` Ссылка на отдельный товар
    - `+` Не показывать товар, если его нет в наличии
  - `+` Товар отдельно
    - `+` Цена
    - `+` Магазин
    - `+` Фото
    - `+` Фото-карусель с другими фотками
    - `+` `Добавить в корзину`
  - `+` Авторизация
  - `+` Регистрация
  - `+` Профиль
    - `+` Баланс
    - `+` Статус
    - `+` Кнопка `Пополнить баланс`
  - `+` Пополнение баланса
  - `+` Корзина
    - `+` Список товаров корзине 
    - `+` Кнопка `Оформить заказ`
  - `+` Оформление заказа
    - `+` Кнопка `Подвердить оплату`
  - `+` Оплата заказа (после нажатия `Подтвердить оплату`)
    - `+` Кнопка `Оплатить заказ`
  - `+` Страница отчёта по продажам
    - `+` Выбор дат периода
      - `+` Учитывать все покупки после даты `Дата начала`
      - `+` Учитывать все покупки до даты `Дата окончания`
      - `+` Учитывать покупки между даты `Дата начала` и `Дата окончания`
    - `+` Кнопка `Сформировать отчёт`


- Таблицы:
  - `добавлена` Пользователи `User` (as `AbstractUser`) (авторизация, регистрация)
  - `добавлена` Профили пользователей `Profile`:
    - добавить поле Баланс `balance (float)`
  - `добавлена` Текущие заказы `Order`:
    - `id` - ид
    - `user` > `User` - пользователь
    - `create_id` - дата формирования заказа (когда пользователь нажал `Оформить заказ`)
    - `paid_it` - дата оплаты заказа (когда на странице оформленного заказа пользователь нажал `Оплатить заказ`)
  - `добавлена` Состав заказа `OrderItems`:
    - `id` - ид
    - `order` > `Order` - Заказ
    - `good` > `Good` - Товар
    - `price [float]` - цена на момент добавления в корзину
  - `не требуется` Корзина `Basket` - оформляется в сессиях:
    - `id` - ид
    - `user` > `User` - Пользователь
    - `good` > `Good` - Товар
      - Цену показывать текущую, из базы
  - `добавлена` Товар `Good`:
    - `id` - ид
    - `title` - название
    - `shop` > `Shop` - Магазин
    - `image` > изображение 
    - `price` > цена
    - `remains` > остаток
  - `добавлена` Магазин `Shop`:
    - `id` - ид
    - `title` - название
  - `добавлена` Статусы:
    - `id` - ид
    - `title` - название
    - `expensess_lt` - если траты пользователя = 0, то Деревянный, 
    иначе - проверять по значению (меньше чем `expensess_lt`, order `DESC`)

- Статусная система
  - ТЗ означает, что требуется еще одна таблица для хранения покупок 
  пользователя (id, user, good, price [на момент покупки])
  - По предыдущему пункту - понадобится еще одна таблица для хранения заказов
    (id, user, unique_id, create_at, paid_at)
  - Статус будет формироваться по списку предыдущих покупок (анализ потраченной суммы и выставление статуса)
- Корзина:
  - ТЗ означает, что нужна таблица с текущим выбранным составом покупок
    (id, user, good)
- Статусы для покупателей:
  - Деревянный покупатель
    - (дефолтный статус, без покупок)
  - Бронзовый покупатель
    - (покупки на сумму до 1000 рублей) - должен потратить 1'000
  - Серебряный покупатель
    - (покупки на сумму до 3000 рублей) - должен потратить 2'000
  - Золотой покупатель
    - (покупки на сумму до 6000 рублей) - должен потратить 3'000
  - Сапфировый покупатель
    - (покупки на сумму до 11'000 рублей) - должен потратить 5'000
  - Рубиновый покупатель
    - (покупки на сумму до 19'000 рублей) - должен потратить 8'000
  - Изумрудный покупатель
    - (покупки на сумму до 32'000 рублей) - должен потратить 13'000
  - Аметистовый покупатель
    - (покупки на сумму до 53'000 рублей) - должен потратить 21'000
  - Жемчужный покупатель
    - (покупки на сумму до 87'000 рублей) - должен потратить 34'000
  - Обсидиановый покупатель
    - (покупки на сумму до 142'000 рублей) - должен потратить 55'000
  - Бриллиантовый покупатель
    - (покупки на сумму до 231'000 рублей) - должен потратить 89'000